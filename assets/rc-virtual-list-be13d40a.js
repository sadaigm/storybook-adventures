import{e as $,b as k,g as lt,c as D,d as $e,_ as Lt,a as _t,k as Tt}from"./@babel-da92e102.js";import{c as Te}from"./classnames-cee3b7bb.js";import{R as ot}from"./rc-resize-observer-efc86fdc.js";import{v as j,G as zt,u as ge,j as Qe}from"./rc-util-8c081dda.js";import{r as t}from"./react-f5969a0a.js";import{r as et}from"./react-dom-50ca325a.js";var st=t.forwardRef(function(e,c){var l=e.height,i=e.offsetY,v=e.offsetX,h=e.children,f=e.prefixCls,u=e.onInnerResize,M=e.innerProps,m=e.rtl,R=e.extra,n={},g={display:"flex",flexDirection:"column"};return i!==void 0&&(n={height:l,position:"relative",overflow:"hidden"},g=$($({},g),{},k(k(k(k(k({transform:"translateY(".concat(i,"px)")},m?"marginRight":"marginLeft",-v),"position","absolute"),"left",0),"right",0),"top",0))),t.createElement("div",{style:n},t.createElement(ot,{onResize:function(d){var o=d.offsetHeight;o&&u&&u()}},t.createElement("div",lt({style:g,className:Te(k({},"".concat(f,"-holder-inner"),f)),ref:c},M),h,R)))});st.displayName="Filler";function Dt(e){var c=e.children,l=e.setRef,i=t.useCallback(function(v){l(v)},[]);return t.cloneElement(c,{ref:i})}function Ct(e,c,l,i,v,h,f,u){var M=u.getKey;return e.slice(c,l+1).map(function(m,R){var n=c+R,g=f(m,n,{style:{width:i},offsetX:v}),a=M(m);return t.createElement(Dt,{key:a,setRef:function(o){return h(m,o)}},g)})}function Ht(e,c,l){var i=e.length,v=c.length,h,f;if(i===0&&v===0)return null;i<v?(h=e,f=c):(h=c,f=e);var u={__EMPTY_ITEM__:!0};function M(d){return d!==void 0?l(d):u}for(var m=null,R=Math.abs(i-v)!==1,n=0;n<f.length;n+=1){var g=M(h[n]),a=M(f[n]);if(g!==a){m=n,R=R||g!==M(f[n+1]);break}}return m===null?null:{index:m,multiple:R}}function Pt(e,c,l){var i=t.useState(e),v=D(i,2),h=v[0],f=v[1],u=t.useState(null),M=D(u,2),m=M[0],R=M[1];return t.useEffect(function(){var n=Ht(h||[],e||[],c);(n==null?void 0:n.index)!==void 0&&(l==null||l(n.index),R(e[n.index])),f(e)},[e]),[m]}var tt=(typeof navigator>"u"?"undefined":$e(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const ct=function(e,c,l,i){var v=t.useRef(!1),h=t.useRef(null);function f(){clearTimeout(h.current),v.current=!0,h.current=setTimeout(function(){v.current=!1},50)}var u=t.useRef({top:e,bottom:c,left:l,right:i});return u.current.top=e,u.current.bottom=c,u.current.left=l,u.current.right=i,function(M,m){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=M?m<0&&u.current.left||m>0&&u.current.right:m<0&&u.current.top||m>0&&u.current.bottom;return R&&n?(clearTimeout(h.current),v.current=!1):(!n||v.current)&&f(),!v.current&&n}};function It(e,c,l,i,v,h,f){var u=t.useRef(0),M=t.useRef(null),m=t.useRef(null),R=t.useRef(!1),n=ct(c,l,i,v);function g(S,E){if(j.cancel(M.current),!n(!1,E)){var x=S;if(!x._virtualHandled)x._virtualHandled=!0;else return;u.current+=E,m.current=E,tt||x.preventDefault(),M.current=j(function(){var X=R.current?10:1;f(u.current*X,!1),u.current=0})}}function a(S,E){f(E,!0),tt||S.preventDefault()}var d=t.useRef(null),o=t.useRef(null);function p(S){if(e){j.cancel(o.current),o.current=j(function(){d.current=null},2);var E=S.deltaX,x=S.deltaY,X=S.shiftKey,I=E,w=x;(d.current==="sx"||!d.current&&X&&x&&!E)&&(I=x,w=0,d.current="sx");var F=Math.abs(I),z=Math.abs(w);d.current===null&&(d.current=h&&F>z?"x":"y"),d.current==="y"?g(S,w):a(S,I)}}function y(S){e&&(R.current=S.detail===m.current)}return[p,y]}function Nt(e,c,l,i){var v=t.useMemo(function(){return[new Map,[]]},[e,l.id,i]),h=D(v,2),f=h[0],u=h[1],M=function(R){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,g=f.get(R),a=f.get(n);if(g===void 0||a===void 0)for(var d=e.length,o=u.length;o<d;o+=1){var p,y=e[o],S=c(y);f.set(S,o);var E=(p=l.get(S))!==null&&p!==void 0?p:i;if(u[o]=(u[o-1]||0)+E,S===R&&(g=o),S===n&&(a=o),g!==void 0&&a!==void 0)break}return{top:u[g-1]||0,bottom:u[a]}};return M}var Ot=function(){function e(){_t(this,e),k(this,"maps",void 0),k(this,"id",0),this.maps=Object.create(null)}return Lt(e,[{key:"set",value:function(l,i){this.maps[l]=i,this.id+=1}},{key:"get",value:function(l){return this.maps[l]}}]),e}();function rt(e){var c=parseFloat(e);return isNaN(c)?0:c}function kt(e,c,l){var i=t.useState(0),v=D(i,2),h=v[0],f=v[1],u=t.useRef(new Map),M=t.useRef(new Ot),m=t.useRef();function R(){j.cancel(m.current)}function n(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;R();var d=function(){u.current.forEach(function(p,y){if(p&&p.offsetParent){var S=zt(p),E=S.offsetHeight,x=getComputedStyle(S),X=x.marginTop,I=x.marginBottom,w=rt(X),F=rt(I),z=E+w+F;M.current.get(y)!==z&&M.current.set(y,z)}}),f(function(p){return p+1})};a?d():m.current=j(d)}function g(a,d){var o=e(a),p=u.current.get(o);d?(u.current.set(o,d),n()):u.current.delete(o),!p!=!d&&(d?c==null||c(a):l==null||l(a))}return t.useEffect(function(){return R},[]),[g,n,M.current,h]}var nt=14/15;function $t(e,c,l){var i=t.useRef(!1),v=t.useRef(0),h=t.useRef(0),f=t.useRef(null),u=t.useRef(null),M,m=function(a){if(i.current){var d=Math.ceil(a.touches[0].pageX),o=Math.ceil(a.touches[0].pageY),p=v.current-d,y=h.current-o,S=Math.abs(p)>Math.abs(y);S?v.current=d:h.current=o;var E=l(S,S?p:y,!1,a);E&&a.preventDefault(),clearInterval(u.current),E&&(u.current=setInterval(function(){S?p*=nt:y*=nt;var x=Math.floor(S?p:y);(!l(S,x,!0)||Math.abs(x)<=.1)&&clearInterval(u.current)},16))}},R=function(){i.current=!1,M()},n=function(a){M(),a.touches.length===1&&!i.current&&(i.current=!0,v.current=Math.ceil(a.touches[0].pageX),h.current=Math.ceil(a.touches[0].pageY),f.current=a.target,f.current.addEventListener("touchmove",m,{passive:!1}),f.current.addEventListener("touchend",R,{passive:!0}))};M=function(){f.current&&(f.current.removeEventListener("touchmove",m),f.current.removeEventListener("touchend",R))},ge(function(){return e&&c.current.addEventListener("touchstart",n,{passive:!0}),function(){var g;(g=c.current)===null||g===void 0||g.removeEventListener("touchstart",n),M(),clearInterval(u.current)}},[e])}function at(e){return Math.floor(Math.pow(e,.5))}function ke(e,c){var l="touches"in e?e.touches[0]:e;return l[c?"pageX":"pageY"]}function Ft(e,c,l){t.useEffect(function(){var i=c.current;if(e&&i){var v=!1,h,f,u=function(){j.cancel(h)},M=function g(){u(),h=j(function(){l(f),g()})},m=function(a){var d=a;d._virtualHandled||(d._virtualHandled=!0,v=!0)},R=function(){v=!1,u()},n=function(a){if(v){var d=ke(a,!1),o=i.getBoundingClientRect(),p=o.top,y=o.bottom;if(d<=p){var S=p-d;f=-at(S),M()}else if(d>=y){var E=d-y;f=at(E),M()}else u()}};return i.addEventListener("mousedown",m),i.ownerDocument.addEventListener("mouseup",R),i.ownerDocument.addEventListener("mousemove",n),function(){i.removeEventListener("mousedown",m),i.ownerDocument.removeEventListener("mouseup",R),i.ownerDocument.removeEventListener("mousemove",n),u()}}},[e])}var Yt=10;function Xt(e,c,l,i,v,h,f,u){var M=t.useRef(),m=t.useState(null),R=D(m,2),n=R[0],g=R[1];return ge(function(){if(n&&n.times<Yt){if(!e.current){g(function(C){return $({},C)});return}h();var a=n.targetAlign,d=n.originAlign,o=n.index,p=n.offset,y=e.current.clientHeight,S=!1,E=a,x=null;if(y){for(var X=a||d,I=0,w=0,F=0,z=Math.min(c.length-1,o),U=0;U<=z;U+=1){var K=v(c[U]);w=I;var Q=l.get(K);F=w+(Q===void 0?i:Q),I=F}for(var ee=X==="top"?p:y-p,Y=z;Y>=0;Y-=1){var re=v(c[Y]),N=l.get(re);if(N===void 0){S=!0;break}if(ee-=N,ee<=0)break}switch(X){case"top":x=w-p;break;case"bottom":x=F-y+p;break;default:{var q=e.current.scrollTop,W=q+y;w<q?E="top":F>W&&(E="bottom")}}x!==null&&f(x),x!==n.lastTop&&(S=!0)}S&&g($($({},n),{},{times:n.times+1,targetAlign:E,lastTop:x}))}},[n,e.current]),function(a){if(a==null){u();return}if(j.cancel(M.current),typeof a=="number")f(a);else if(a&&$e(a)==="object"){var d,o=a.align;"index"in a?d=a.index:d=c.findIndex(function(S){return v(S)===a.key});var p=a.offset,y=p===void 0?0:p;g({times:0,index:d,offset:y,originAlign:o})}}}var it=t.forwardRef(function(e,c){var l=e.prefixCls,i=e.rtl,v=e.scrollOffset,h=e.scrollRange,f=e.onStartMove,u=e.onStopMove,M=e.onScroll,m=e.horizontal,R=e.spinSize,n=e.containerSize,g=e.style,a=e.thumbStyle,d=t.useState(!1),o=D(d,2),p=o[0],y=o[1],S=t.useState(null),E=D(S,2),x=E[0],X=E[1],I=t.useState(null),w=D(I,2),F=w[0],z=w[1],U=!i,K=t.useRef(),Q=t.useRef(),ee=t.useState(!1),Y=D(ee,2),re=Y[0],N=Y[1],q=t.useRef(),W=function(){clearTimeout(q.current),N(!0),q.current=setTimeout(function(){N(!1)},3e3)},C=h-n||0,le=n-R||0,_=t.useMemo(function(){if(v===0||C===0)return 0;var O=v/C;return O*le},[v,C,le]),J=function(L){L.stopPropagation(),L.preventDefault()},ne=t.useRef({top:_,dragging:p,pageY:x,startTop:F});ne.current={top:_,dragging:p,pageY:x,startTop:F};var ae=function(L){y(!0),X(ke(L,m)),z(ne.current.top),f(),L.stopPropagation(),L.preventDefault()};t.useEffect(function(){var O=function(ie){ie.preventDefault()},L=K.current,V=Q.current;return L.addEventListener("touchstart",O,{passive:!1}),V.addEventListener("touchstart",ae,{passive:!1}),function(){L.removeEventListener("touchstart",O),V.removeEventListener("touchstart",ae)}},[]);var Se=t.useRef();Se.current=C;var oe=t.useRef();oe.current=le,t.useEffect(function(){if(p){var O,L=function(ie){var se=ne.current,pe=se.dragging,Me=se.pageY,be=se.startTop;j.cancel(O);var Ee=K.current.getBoundingClientRect(),te=n/(m?Ee.width:Ee.height);if(pe){var ce=(ke(ie,m)-Me)*te,fe=be;!U&&m?fe-=ce:fe+=ce;var ye=Se.current,xe=oe.current,ze=xe?fe/xe:0,G=Math.ceil(ze*ye);G=Math.max(G,0),G=Math.min(G,ye),O=j(function(){M(G,m)})}},V=function(){y(!1),u()};return window.addEventListener("mousemove",L,{passive:!0}),window.addEventListener("touchmove",L,{passive:!0}),window.addEventListener("mouseup",V,{passive:!0}),window.addEventListener("touchend",V,{passive:!0}),function(){window.removeEventListener("mousemove",L),window.removeEventListener("touchmove",L),window.removeEventListener("mouseup",V),window.removeEventListener("touchend",V),j.cancel(O)}}},[p]),t.useEffect(function(){return W(),function(){clearTimeout(q.current)}},[v]),t.useImperativeHandle(c,function(){return{delayHidden:W}});var H="".concat(l,"-scrollbar"),B={position:"absolute",visibility:re?null:"hidden"},A={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return m?(B.height=8,B.left=0,B.right=0,B.bottom=0,A.height="100%",A.width=R,U?A.left=_:A.right=_):(B.width=8,B.top=0,B.bottom=0,U?B.right=0:B.left=0,A.width="100%",A.height=R,A.top=_),t.createElement("div",{ref:K,className:Te(H,k(k(k({},"".concat(H,"-horizontal"),m),"".concat(H,"-vertical"),!m),"".concat(H,"-visible"),re)),style:$($({},B),g),onMouseDown:J,onMouseMove:W},t.createElement("div",{ref:Q,className:Te("".concat(H,"-thumb"),k({},"".concat(H,"-thumb-moving"),p)),style:$($({},A),a),onMouseDown:ae}))}),Wt=20;function ut(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=e/c*e;return isNaN(l)&&(l=0),l=Math.max(l,Wt),Math.floor(l)}var Bt=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles"],Vt=[],jt={overflowY:"auto",overflowAnchor:"none"};function Kt(e,c){var l=e.prefixCls,i=l===void 0?"rc-virtual-list":l,v=e.className,h=e.height,f=e.itemHeight,u=e.fullHeight,M=u===void 0?!0:u,m=e.style,R=e.data,n=e.children,g=e.itemKey,a=e.virtual,d=e.direction,o=e.scrollWidth,p=e.component,y=p===void 0?"div":p,S=e.onScroll,E=e.onVirtualScroll,x=e.onVisibleChange,X=e.innerProps,I=e.extraRender,w=e.styles,F=Tt(e,Bt),z=t.useCallback(function(s){return typeof g=="function"?g(s):s==null?void 0:s[g]},[g]),U=kt(z,null,null),K=D(U,4),Q=K[0],ee=K[1],Y=K[2],re=K[3],N=!!(a!==!1&&h&&f),q=t.useMemo(function(){return Object.values(Y.maps).reduce(function(s,r){return s+r},0)},[Y.id,Y.maps]),W=N&&R&&(Math.max(f*R.length,q)>h||!!o),C=d==="rtl",le=Te(i,k({},"".concat(i,"-rtl"),C),v),_=R||Vt,J=t.useRef(),ne=t.useRef(),ae=t.useRef(),Se=t.useState(0),oe=D(Se,2),H=oe[0],B=oe[1],A=t.useState(0),O=D(A,2),L=O[0],V=O[1],Re=t.useState(!1),ie=D(Re,2),se=ie[0],pe=ie[1],Me=function(){pe(!0)},be=function(){pe(!1)},Ee={getKey:z};function te(s){B(function(r){var b;typeof s=="function"?b=s(r):b=s;var T=gt(b);return J.current.scrollTop=T,T})}var ce=t.useRef({start:0,end:_.length}),fe=t.useRef(),ye=Pt(_,z),xe=D(ye,1),ze=xe[0];fe.current=ze;var G=t.useMemo(function(){if(!N)return{scrollHeight:void 0,start:0,end:_.length-1,offset:void 0};if(!W){var s;return{scrollHeight:((s=ne.current)===null||s===void 0?void 0:s.offsetHeight)||0,start:0,end:_.length-1,offset:void 0}}for(var r=0,b,T,P,qe=_.length,me=0;me<qe;me+=1){var xt=_[me],wt=z(xt),Je=Y.get(wt),Oe=r+(Je===void 0?f:Je);Oe>=H&&b===void 0&&(b=me,T=r),Oe>H+h&&P===void 0&&(P=me),r=Oe}return b===void 0&&(b=0,T=0,P=Math.ceil(h/f)),P===void 0&&(P=_.length-1),P=Math.min(P+1,_.length-1),{scrollHeight:r,start:b,end:P,offset:T}},[W,N,H,_,re,h]),ue=G.scrollHeight,ve=G.start,de=G.end,Fe=G.offset;ce.current.start=ve,ce.current.end=de;var ft=t.useState({width:0,height:h}),Ye=D(ft,2),Z=Ye[0],vt=Ye[1],dt=function(r){vt({width:r.offsetWidth,height:r.offsetHeight})},Xe=t.useRef(),We=t.useRef(),ht=t.useMemo(function(){return ut(Z.width,o)},[Z.width,o]),mt=t.useMemo(function(){return ut(Z.height,ue)},[Z.height,ue]),De=ue-h,Ce=t.useRef(De);Ce.current=De;function gt(s){var r=s;return Number.isNaN(Ce.current)||(r=Math.min(r,Ce.current)),r=Math.max(r,0),r}var we=H<=0,Le=H>=De,Be=L<=0,Ve=L>=o,St=ct(we,Le,Be,Ve),He=function(){return{x:C?-L:L,y:H}},Pe=t.useRef(He()),_e=Qe(function(s){if(E){var r=$($({},He()),s);(Pe.current.x!==r.x||Pe.current.y!==r.y)&&(E(r),Pe.current=r)}});function je(s,r){var b=s;r?(et.flushSync(function(){V(b)}),_e()):te(b)}function Rt(s){var r=s.currentTarget.scrollTop;r!==H&&te(r),S==null||S(s),_e()}var Ie=function(r){var b=r,T=o?o-Z.width:0;return b=Math.max(b,0),b=Math.min(b,T),b},pt=Qe(function(s,r){r?(et.flushSync(function(){V(function(b){var T=b+(C?-s:s);return Ie(T)})}),_e()):te(function(b){var T=b+s;return T})}),Mt=It(N,we,Le,Be,Ve,!!o,pt),Ke=D(Mt,2),Ne=Ke[0],Ae=Ke[1];$t(N,J,function(s,r,b,T){var P=T;return St(s,r,b)?!1:!P||!P._virtualHandled?(P&&(P._virtualHandled=!0),Ne({preventDefault:function(){},deltaX:s?r:0,deltaY:s?0:r}),!0):!1}),Ft(W,J,function(s){te(function(r){return r+s})}),ge(function(){function s(b){var T=we&&b.detail<0,P=Le&&b.detail>0;N&&!T&&!P&&b.preventDefault()}var r=J.current;return r.addEventListener("wheel",Ne,{passive:!1}),r.addEventListener("DOMMouseScroll",Ae,{passive:!0}),r.addEventListener("MozMousePixelScroll",s,{passive:!1}),function(){r.removeEventListener("wheel",Ne),r.removeEventListener("DOMMouseScroll",Ae),r.removeEventListener("MozMousePixelScroll",s)}},[N,we,Le]),ge(function(){if(o){var s=Ie(L);V(s),_e({x:s})}},[Z.width,o]);var Ge=function(){var r,b;(r=Xe.current)===null||r===void 0||r.delayHidden(),(b=We.current)===null||b===void 0||b.delayHidden()},Ue=Xt(J,_,Y,f,z,function(){return ee(!0)},te,Ge);t.useImperativeHandle(c,function(){return{nativeElement:ae.current,getScrollInfo:He,scrollTo:function(r){function b(T){return T&&$e(T)==="object"&&("left"in T||"top"in T)}b(r)?(r.left!==void 0&&V(Ie(r.left)),Ue(r.top)):Ue(r)}}}),ge(function(){if(x){var s=_.slice(ve,de+1);x(s,_)}},[ve,de,_]);var bt=Nt(_,z,Y,f),Et=I==null?void 0:I({start:ve,end:de,virtual:W,offsetX:L,offsetY:Fe,rtl:C,getSize:bt}),yt=Ct(_,ve,de,o,L,Q,n,Ee),he=null;h&&(he=$(k({},M?"height":"maxHeight",h),jt),N&&(he.overflowY="hidden",o&&(he.overflowX="hidden"),se&&(he.pointerEvents="none")));var Ze={};return C&&(Ze.dir="rtl"),t.createElement("div",lt({ref:ae,style:$($({},m),{},{position:"relative"}),className:le},Ze,F),t.createElement(ot,{onResize:dt},t.createElement(y,{className:"".concat(i,"-holder"),style:he,ref:J,onScroll:Rt,onMouseEnter:Ge},t.createElement(st,{prefixCls:i,height:ue,offsetX:L,offsetY:Fe,scrollWidth:o,onInnerResize:ee,ref:ne,innerProps:X,rtl:C,extra:Et},yt))),W&&ue>h&&t.createElement(it,{ref:Xe,prefixCls:i,scrollOffset:H,scrollRange:ue,rtl:C,onScroll:je,onStartMove:Me,onStopMove:be,spinSize:mt,containerSize:Z.height,style:w==null?void 0:w.verticalScrollBar,thumbStyle:w==null?void 0:w.verticalScrollBarThumb}),W&&o>Z.width&&t.createElement(it,{ref:We,prefixCls:i,scrollOffset:L,scrollRange:o,rtl:C,onScroll:je,onStartMove:Me,onStopMove:be,spinSize:ht,containerSize:Z.width,horizontal:!0,style:w==null?void 0:w.horizontalScrollBar,thumbStyle:w==null?void 0:w.horizontalScrollBarThumb}))}var At=t.forwardRef(Kt);At.displayName="List";export{At as L};
//# sourceMappingURL=rc-virtual-list-be13d40a.js.map
